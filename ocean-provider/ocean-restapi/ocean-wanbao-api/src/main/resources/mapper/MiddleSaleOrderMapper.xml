<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fantechs.provider.wanbao.api.mapper.MiddleSaleOrderMapper">
    <resultMap id="BaseResultMap" type="com.fantechs.provider.wanbao.api.entity.MiddleMaterial">
        <id column="middle_material_id" jdbcType="BIGINT" property="middleMaterialId"/>
        <result column="sales_order_code" jdbcType="VARCHAR" property="salesOrderCode" />
        <result column="supplier_code" jdbcType="VARCHAR" property="supplierCode"/>
        <result column="order_status" jdbcType="TINYINT" property="orderStatus" />
        <result column="order_type" jdbcType="VARCHAR" property="orderType" />
        <result column="customer_product_model" jdbcType="VARCHAR" property="customerProductModel" />
        <result column="customer_order_line_number" jdbcType="VARCHAR" property="customerOrderLineNumber" />
        <result column="sales_code" jdbcType="VARCHAR" property="salesCode" />
        <result column="make_code" jdbcType="VARCHAR" property="makeCode" />
        <result column="material_name" jdbcType="VARCHAR" property="materialName"/>
        <result column="order_qty" jdbcType="DECIMAL" property="orderQty" />
        <result column="make_order_date" jdbcType="TIMESTAMP" property="makeOrderDate" />
        <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
        <result column="modified_time" jdbcType="TIMESTAMP" property="modifiedTime" />
    </resultMap>

    <select id="setPolicy" >
        begin
        mo_global.set_policy_context('S',81);
        end;
    </select>

    <select id="findSaleOrderData" parameterType="map" resultMap="BaseResultMap">
        SELECT
            mh.mo_number AS sales_order_code,
            mh.CUSTOMER_NUMBER AS supplier_code,
            mh.mo_status AS order_status,
            mh.order_type_name AS order_type,
            mh.salesperson_name 创建人,
            mld.factory_code AS factory_code,
            mld.CUSTOMER_MODEL AS customer_product_model,
            mld.product_code AS sales_code,
            mld.Wb_Make_Code AS make_code,
            mld.product_description AS material_name,
            mld.CUST_TRADEMARK_NAME 客户商标,
            mld.quantity AS order_qty,
            mh.order_date AS make_order_date,
            mld.LINE_NUMBER AS customer_order_line_number,
            mh.creation_date AS create_time,
            mh.LAST_UPDATE_DATE AS modified_time
        FROM
            apps.oms_mo_headers_v mh,
            apps.oms_mo_line_details_v mld
        WHERE
            mld.mo_header_id = mh.mo_header_id
          AND mh.org_id = 81
    </select>

</mapper>